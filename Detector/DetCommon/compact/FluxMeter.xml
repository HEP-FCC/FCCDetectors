<?xml version="1.0" encoding="UTF-8"?>
<lccdd xmlns:compact="http://www.lcsim.org/schemas/compact/1.0"
       xmlns:xs="http://www.w3.org/2001/XMLSchema"
       xs:noNamespaceSchemaLocation="http://www.lcsim.org/schemas/compact/1.0/compact.xsd">

  <info name="FluxMeter"
    title="FCC flux meter"
    author="J. Smiesko"
    url="no"
    status="development"
    version="0.1">
    <comment>
      Measures particle flux comming from the detector(s) it envelopes.
    </comment>
  </info>

  <define>
    <constant name="Flux_thickness" value="5*mm" />
    <!-- <constant name="Flux_r" value="MuonTagger_outer_radius" />
    <constant name="Flux_z" value="MuonTaggerEndcap_max_z" /> -->
    <!-- <constant name="Flux_r" value="YokeEndcap_outer_radius" />
    <constant name="Flux_z" value="YokeEndcap_max_z" /> -->
    <constant name="Flux_r" value="Solenoid_outer_radius + 5*mm" />
    <constant name="Flux_z" value="world_z - 5*mm" />
  </define>

  <display>
    <vis name="FluxMeterVis"
         r="0.2" g="0.6" b="0.2" alpha="1"
         showDaughters="false"
         visible="true" />
  </display>

  <readouts>
    <readout name="FluxPhiTheta">
      <segmentation type="FCCSWGridPhiTheta"
                    grid_size_theta="1."
                    phi_bins="704"
                    offset_theta="-pi"
                    offset_phi="-pi+(pi/704.)"/>
      <id>system:4,theta:9,phi:10</id>
    </readout>
  </readouts>

  <detectors>
    <detector name="FluxBarrel"
              type="SimpleCylinder"
              id="97"
              readout="FluxPhiTheta"
              sensitive="true"
              vis="FluxMeterVis">
      <material name="Vacuum" />
      <sensitive type="FluxMeter" />
      <dimensions rmin="Flux_r"
                  rmax="Flux_r + Flux_thickness"
                  dz="Flux_z"
                  phi0="0"
                  deltaphi="360*deg"
                  z_offset="0*cm"
                  material="Vacuum" />
    </detector>
    <detector name="FluxEndcapNegative"
              type="SimpleCylinder"
              id="98"
              readout="FluxPhiTheta"
              sensitive="true"
              vis="FluxMeterVis">
      <material name="Vacuum" />
      <sensitive type="FluxMeter" />
      <dimensions rmin="BeamPipeWidth / 2.0"
                  rmax="Flux_r + Flux_thickness"
                  dz="Flux_thickness / 2.0"
                  phi0="0"
                  deltaphi="360*deg"
                  z_offset="-(Flux_z + Flux_thickness / 2.0)"
                  material="Vacuum" />
    </detector>
    <detector name="FluxEndcapPositive"
              type="SimpleCylinder"
              id="99"
              readout="FluxPhiTheta"
              sensitive="true"
              vis="FluxMeterVis">
      <material name="Vacuum" />
      <sensitive type="FluxMeter" />
      <dimensions rmin="BeamPipeWidth / 2"
                  rmax="Flux_r + Flux_thickness"
                  dz="Flux_thickness / 2.0"
                  phi0="0"
                  deltaphi="360*deg"
                  z_offset="Flux_z + Flux_thickness / 2.0"
                  material="Vacuum" />
    </detector>
  </detectors>

</lccdd>
