<!-- Changes :
   o4_v04 : scaled version of the CLIC VTX Barrel (CLIC_04_v11); distance between sensitive layers in double layers are set to 1*mm and is similar in all 3 layers
-->

<lccdd>

    <info name="FCCee"
        title="FCCee Vertex detector: taken correspoding to CLD: Vertex_o4_v05.xml, but adapted to IDEA vertex detector"
        author="nalipour taken from lcgeo (CLD version), adapted by Armin Ilg (IDEA version)"
        url="no"
        status="development"
        version="1.1">
    <comment>A Vertex Detector for FCCee IDEA detector concept</comment>
  </info>

    <comment>Tracking detectors</comment>
    <detectors>
        <detector name="Vertex" type="DD4hep_SubdetectorAssembly" vis="VXDVis">
		<shape type="BooleanShape" operation="Subtraction" material="Air">
		    <shape type="BooleanShape" operation="Subtraction">
			<shape type="Tube" rmin="Inner_Vertex_inner_radius" rmax="Outer_Vertex_outer_radius" dz="Outer_Vertex_half_length"/>
		        <shape type="Cone" rmin1="0" rmax1="0.150*Inner_Vertex_half_length-env_safety" rmin2="0" rmax2="Inner_Vertex_inner_radius" z="((Inner_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety)"/>
		        <position x="0" y="0" z="-(CentralBeamPipe_zmax+(Inner_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety)" />
		    </shape>
		    <shape type="Cone" rmin1="0" rmax1="Inner_Vertex_inner_radius" rmin2="0" rmax2="0.150*Inner_Vertex_half_length-env_safety" z="(Inner_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety"/>
		    <position x="0" y="0" z="CentralBeamPipe_zmax+(Inner_Vertex_half_length-CentralBeamPipe_zmax)/2+env_safety" />
		</shape>
            <comment>Vertex Assembly</comment>
            <composite name="VertexBarrel"/>
            <composite name="VertexEndcap"/>
            <composite name="VertexVerticalCable"/>
        </detector>
    </detectors>
    
    <display>
        <vis name="SiVertexModuleVis"    alpha="1.0" r="1" g="1"    b="0.6"     showDaughters="true"  visible="true"/>
        <vis name="SiVertexSensitiveVis" alpha="1.0" r="0.5" g="0.5"  b="0"     showDaughters="true"  visible="true"/>
        <vis name="SiVertexPassiveVis"   alpha="0.0" r="0.4" g="0.5"  b="0"       showDaughters="true"  visible="true"/>
        <vis name="SiVertexCableVis"     alpha="0.0" r="0.85" g="0.53"    b="0.4"       showDaughters="true"  visible="true"/>
        <vis name="CarbonFiberVis"          alpha="1.0" r="0.5" g="0.5"    b="0.5"       showDaughters="true"  visible="true"/>
        <vis name="SiVertexAir"          alpha="1.0" r="0" g="0"    b="0"       showDaughters="false"  visible="false"/>
    </display>
     
    <define>

        <!-- Sensor characteristics -->
        <!-- Let's take the ARCADIA chip! -->
        <constant name="chip_z" value="2.56*cm"/> <!-- Chip length-->       
        <constant name="chip_width_sensitive" value="6.4*mm"/> <!-- Chip length: Sensitive-->
        <constant name="chip_width_periphery" value="2*mm"/> <!-- Chip length: Periphery-->
        <constant name="chip_width" value="chip_width_sensitive+chip_width_periphery"/> <!-- Chip length: Sensitive-->

        <!-- Module with two ARCADIA chips -->
        <constant name="dual_z" value="chip_z*2"/> 
        <constant name="dual_z_spacing" value="1*mm"/>
        <constant name="dual_width_sensitive" value="chip_width_sensitive"/> 
        <constant name="dual_width_periphery" value="chip_width_periphery"/>
        <constant name="dual_width" value="chip_width"/>

        <constant name="VertexBarrel_Layer1_nModules" value="4"/>
        <constant name="VertexBarrel_Layer2_nModules" value="6"/>
        <constant name="VertexBarrel_Layer3_nModules" value="10"/>

        <constant name="VertexBarrel_z1" value="(VertexBarrel_Layer1_nModules*dual_z+(VertexBarrel_Layer1_nModules-1)*dual_z_spacing)/2."/>
        <constant name="VertexBarrel_z2" value="(VertexBarrel_Layer2_nModules*dual_z+(VertexBarrel_Layer2_nModules-1)*dual_z_spacing)/2."/>
        <constant name="VertexBarrel_z3" value="(VertexBarrel_Layer3_nModules*dual_z+(VertexBarrel_Layer3_nModules-1)*dual_z_spacing)/2."/>        
    	<constant name="VertexBarrel_r1" value="1.2*cm"/> 
        <constant name="VertexBarrel_r2" value="2.0*cm"/>
        <constant name="VertexBarrel_r3" value="3.2*cm"/>

        <constant name="VertexBarrel_Sensitive_Thickness"   value="5.000000000e-02*mm"/>
    	<constant name="VertexBarrel_Support_Thickness"     value="23.500000000e-02*mm"/> <!-- +50% more material budget as in CLIC VTX -->
	    <constant name="VertexBarrel_DoubleLayer_Gap"       value="1.0*mm"/> <!-- FCC-ee VTX detector is "scaled" version of the CLIC VTX. However one want to keep constant width of double layers (which is not the case if one directly scale all dimentions). This is why gap was chosen to be 1mm to avoid holes in coverage as function of phi -->

        <constant name="VertexEndcap_Sensitive_Thickness"   value="5.000000000e-02*mm"/>
        <constant name="VertexEndcap_Support_Thickness"     value="28.000000000e-02*mm"/> <!-- +50% more material budget as in CLIC VTX -->
        <constant name="VertexEndcap_DoubleLayer_Gap"       value="2.0*mm"/>

        <constant name="VertexBarrel_Layer1_width_sensitive" value="dual_width_sensitive"/> 
        <constant name="VertexBarrel_Layer2_width_sensitive" value="dual_width_sensitive"/>
        <constant name="VertexBarrel_Layer3_width_sensitive" value="dual_width_sensitive"/>

        <constant name="VertexBarrel_Layer1_width_periphery" value="dual_width_periphery"/>
        <constant name="VertexBarrel_Layer2_width_periphery" value="dual_width_periphery"/>
        <constant name="VertexBarrel_Layer3_width_periphery" value="dual_width_periphery"/>

        <constant name="VertexBarrel_Layer1_width" value="dual_width"/>
        <constant name="VertexBarrel_Layer2_width" value="dual_width"/>
        <constant name="VertexBarrel_Layer3_width" value="dual_width"/>

        <constant name="VertexBarrel_Layer3_overlap" value="0.5*mm"/>        
        <constant name="VertexBarrel_Layer3_offset_r" value="0.5*mm"/>
        
        <constant name="VertexBarrel_Layer1_offset" value="1.87*mm"/>
        <constant name="VertexBarrel_Layer2_offset" value="2.7*mm"/>
        <constant name="VertexBarrel_Layer3_offset" value="5.0*mm"/>
        
        <constant name="VertexBarrel_Layer1_Staves" value="13"/>
        <constant name="VertexBarrel_Layer2_Staves" value="22"/>
        <constant name="VertexBarrel_Layer3_Staves" value="18"/>
        
        <constant name="VertexEndcap_rmax" value="102*mm"/>
        <constant name="VertexEndcap_z1" value="160*mm"/>
        <constant name="VertexEndcap_z2" value="230*mm"/>
        <constant name="VertexEndcap_z3" value="300*mm"/>
        <constant name="VertexEndcapModules" value="8"/>
	    <constant name="VertexEndcap_rmin1" value="24*mm"/>
        <constant name="VertexEndcap_rmin2" value="34.5*mm"/>
        <constant name="VertexEndcap_rmin3" value="45*mm"/>
        <constant name="VertexEndcapModuleThickness" value="1.22*mm"/>
        <constant name="VertexEndcapOverlap" value="0*mm"/>
    </define>


        <!-- Flex for vertex readout, assume 100 µm total thickness, with two 18 µm copper layers and the rest kapton-->
        <constant name="FlexWidth" value="chip_width"/>
        <constant name="FlexCopperThickness" value="2*18e-3*mm"/>
        <constant name="FlexKaptonThickness" value="100e-3*mm-2*18e-3*mm"/>

    <!-- Central beam pipe proxy (simple tube) -->


    <!--  Definition of the readout segmentation/definition  -->
    <readouts>
        <readout name="VertexBarrelCollection">
            <id>${GlobalTrackerReadoutID}</id>
        </readout>
        <readout name="VertexEndcapCollection">
            <id>${GlobalTrackerReadoutID}</id>
        </readout>
    </readouts>

    <detectors>
        <detector id="DetID_VXD_Endcap" name="VertexEndcap" type="VertexEndcap_o1_v06" readout="VertexEndcapCollection" reflect="true" region="VertexEndcapRegion">
            <envelope vis="VXDVis">
                <shape type="Assembly"/>
            </envelope>
            <comment>Vertex Detector Endcaps</comment>
        <sensitive type="SimpleTrackerSD"/>

        <type_flags type=" DetType_TRACKER + DetType_PIXEL + DetType_VERTEX + DetType_ENDCAP"/>
<!--
            <module name="SiVertexEndcapModule1" vis="SiVertexModuleVis">
                <trd x1="VertexEndcap_rmin1 * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" x2="VertexEndcap_rmax * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" z="(VertexEndcap_rmax - VertexEndcap_rmin1) / 2" />
                <module_component thickness="VertexEndcap_Support_Thickness/2.0"  material="Silicon" vis="SiVertexPassiveVis"/>
                <module_component thickness="VertexEndcap_Sensitive_Thickness/2.0"  material="Silicon" sensitive="true" vis="SiVertexSensitiveVis"/>
                <module_component thickness="VertexEndcap_DoubleLayer_Gap/2.0"  material="Air" vis="SiVertexAir" />
            </module>

            <module name="SiVertexEndcapModule2" vis="SiVertexModuleVis">
                <trd x1="VertexEndcap_rmin1 * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" x2="VertexEndcap_rmax * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" z="(VertexEndcap_rmax - VertexEndcap_rmin1) / 2" />
                <module_component thickness="VertexEndcap_DoubleLayer_Gap/2.0"  material="Air" vis="SiVertexAir" />
                <module_component thickness="VertexEndcap_Sensitive_Thickness/2.0"  material="Silicon" sensitive="true" vis="SiVertexSensitiveVis"/>
                <module_component thickness="VertexEndcap_Support_Thickness/2.0"  material="Silicon" vis="SiVertexPassiveVis"/>
            </module>

            <module name="SiVertexEndcapModule3" vis="SiVertexModuleVis">
                <trd x1="VertexEndcap_rmin2 * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" x2="VertexEndcap_rmax * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" z="(VertexEndcap_rmax - VertexEndcap_rmin2) / 2" />
                <module_component thickness="VertexEndcap_Support_Thickness/2.0"  material="Silicon" vis="SiVertexPassiveVis"/>
                <module_component thickness="VertexEndcap_Sensitive_Thickness/2.0"  material="Silicon" sensitive="true" vis="SiVertexSensitiveVis"/>
                <module_component thickness="VertexEndcap_DoubleLayer_Gap/2.0"  material="Air" vis="SiVertexAir" />
            </module>

            <module name="SiVertexEndcapModule4" vis="SiVertexModuleVis">
                <trd x1="VertexEndcap_rmin2 * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" x2="VertexEndcap_rmax * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" z="(VertexEndcap_rmax - VertexEndcap_rmin2) / 2" />
                <module_component thickness="VertexEndcap_DoubleLayer_Gap/2.0"  material="Air" vis="SiVertexAir" />
                <module_component thickness="VertexEndcap_Sensitive_Thickness/2.0"  material="Silicon" sensitive="true" vis="SiVertexSensitiveVis"/>
                <module_component thickness="VertexEndcap_Support_Thickness/2.0"  material="Silicon" vis="SiVertexPassiveVis"/>
            </module>

            <module name="SiVertexEndcapModule5" vis="SiVertexModuleVis">
                <trd x1="VertexEndcap_rmin3 * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" x2="VertexEndcap_rmax * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" z="(VertexEndcap_rmax - VertexEndcap_rmin3) / 2" />
                <module_component thickness="VertexEndcap_Support_Thickness/2.0"  material="Silicon" vis="SiVertexPassiveVis"/>
                <module_component thickness="VertexEndcap_Sensitive_Thickness/2.0"  material="Silicon" sensitive="true" vis="SiVertexSensitiveVis"/>
                <module_component thickness="VertexEndcap_DoubleLayer_Gap/2.0"  material="Air" vis="SiVertexAir" />
            </module>

            <module name="SiVertexEndcapModule6" vis="SiVertexModuleVis">
                <trd x1="VertexEndcap_rmin3 * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" x2="VertexEndcap_rmax * tan(pi/(VertexEndcapModules))+VertexEndcapOverlap*sin(pi/VertexEndcapModules)" z="(VertexEndcap_rmax - VertexEndcap_rmin3) / 2" />
                <module_component thickness="VertexEndcap_DoubleLayer_Gap/2.0"  material="Air" vis="SiVertexAir" />
                <module_component thickness="VertexEndcap_Sensitive_Thickness/2.0"  material="Silicon" sensitive="true" vis="SiVertexSensitiveVis"/>
                <module_component thickness="VertexEndcap_Support_Thickness/2.0"  material="Silicon" vis="SiVertexPassiveVis"/>
            </module>

            <layer id="0"  vis="SiVertexLayerVis">
                <ring r="(VertexEndcap_rmax + VertexEndcap_rmin1) / 2" zstart="VertexEndcap_z1 - VertexEndcapModuleThickness/2.0" nmodules="(int) VertexEndcapModules" dz="0*cm" phi0="pi/(VertexEndcapModules)" module="SiVertexEndcapModule1"/>
            </layer>
            <layer id="1"  vis="SiVertexLayerVis">
                <ring r="(VertexEndcap_rmax + VertexEndcap_rmin1) / 2" zstart="VertexEndcap_z1+VertexEndcapModuleThickness/2.0" nmodules="(int) VertexEndcapModules" dz="0*cm" phi0="pi/(VertexEndcapModules)" module="SiVertexEndcapModule2"/>
            </layer>
            <layer id="2"  vis="SiVertexLayerVis">
                <ring r="(VertexEndcap_rmax + VertexEndcap_rmin2) / 2" zstart="VertexEndcap_z2-VertexEndcapModuleThickness/2.0" nmodules="(int) VertexEndcapModules" dz="0*cm" phi0="pi/(VertexEndcapModules)" module="SiVertexEndcapModule3"/>
            </layer>
            <layer id="3"  vis="SiVertexLayerVis">
                <ring r="(VertexEndcap_rmax + VertexEndcap_rmin2) / 2" zstart="VertexEndcap_z2+VertexEndcapModuleThickness/2.0" nmodules="(int) VertexEndcapModules" dz="0*cm" phi0="pi/(VertexEndcapModules)" module="SiVertexEndcapModule4"/>
            </layer>

            <layer id="4"  vis="SiVertexLayerVis">
                <ring r="(VertexEndcap_rmax + VertexEndcap_rmin3) / 2" zstart="VertexEndcap_z3-VertexEndcapModuleThickness/2.0" nmodules="(int) VertexEndcapModules" dz="0*cm" phi0="pi/(VertexEndcapModules)" module="SiVertexEndcapModule5"/>
            </layer>
            <layer id="5"  vis="SiVertexLayerVis">
                <ring r="(VertexEndcap_rmax + VertexEndcap_rmin3) / 2" zstart="VertexEndcap_z3+VertexEndcapModuleThickness/2.0" nmodules="(int) VertexEndcapModules" dz="0*cm" phi0="pi/(VertexEndcapModules)" module="SiVertexEndcapModule6"/>
            </layer>
        -->
        </detector>
    </detectors>

    <detectors>
        <detector name="VertexBarrel" type="ZPlanarTracker" vis="VXDVis" id="DetID_VXD_Barrel" readout="VertexBarrelCollection"  region="VertexBarrelRegion">

            <type_flags type=" DetType_TRACKER + DetType_PIXEL + DetType_VERTEX + DetType_BARREL"/>


            <layer nLadders="VertexBarrel_Layer1_Staves" phi0="0" id="0">
                <!-- First comes the support structure -->
                <ladder    distance="VertexBarrel_r1" thickness="VertexBarrel_Support_Thickness" width="VertexBarrel_Layer1_width" length="VertexBarrel_z1" offset="VertexBarrel_Layer1_offset"    material="CarbonFiber"  vis="CarbonFiberVis" />

                <!-- Then the sensor -->
                <sensitive distance="VertexBarrel_r1+VertexBarrel_Support_Thickness" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer1_width_sensitive" length="VertexBarrel_z1" offset="VertexBarrel_Layer1_offset-VertexBarrel_Layer1_width_periphery/2" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexBarrel_Layer1_nModules" dz="dual_z_spacing" z_length="dual_z"/>

                <!-- with its passive periphery 
                <ladder    distance="VertexBarrel_r1+VertexBarrel_Support_Thickness" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer1_width_periphery" length="VertexBarrel_z1" offset="VertexBarrel_Layer1_offset-VertexBarrel_Layer1_width_periphery+VertexBarrel_Layer1_width_sensitive"    material="Copper"  vis="SiVertexPassiveVis"/>
                -->
                <!-- Then the flex
                <ladder    distance="VertexBarrel_r1+VertexBarrel_Support_Thickness+VertexBarrel_Sensitive_Thickness" thickness="FlexCopperThickness" width="FlexWidth" length="VertexBarrel_z1" offset="VertexBarrel_Layer1_offset"    material="Copper"  vis="SiVertexCableVis"/>
                <ladder    distance="VertexBarrel_r1+VertexBarrel_Support_Thickness+VertexBarrel_Sensitive_Thickness+FlexCopperThickness" thickness="FlexKaptonThickness" width="FlexWidth" length="VertexBarrel_z1" offset="VertexBarrel_Layer1_offset"    material="Kapton"  vis="SiVertexCableVis"/>
                -->
            </layer>


            <layer nLadders="VertexBarrel_Layer2_Staves" phi0="0" id="1">
                <!-- First comes the support structure -->
                <ladder    distance="VertexBarrel_r2" thickness="VertexBarrel_Support_Thickness" width="VertexBarrel_Layer2_width" length="VertexBarrel_z2" offset="VertexBarrel_Layer2_offset"    material="CarbonFiber"  vis="CarbonFiberVis"/>

                <!-- Then the sensor -->
                <sensitive distance="VertexBarrel_r2+VertexBarrel_Support_Thickness" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer2_width_sensitive" length="VertexBarrel_z2" offset="VertexBarrel_Layer2_offset-VertexBarrel_Layer2_width_periphery/2" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexBarrel_Layer2_nModules" dz="dual_z_spacing" z_length="dual_z"/>

                <!-- with its passive periphery
                <ladder    distance="VertexBarrel_r2+VertexBarrel_Support_Thickness" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer2_width_periphery" length="VertexBarrel_z2" offset="VertexBarrel_Layer2_offset-VertexBarrel_Layer2_width_periphery+VertexBarrel_Layer2_width_sensitive"    material="Copper"  vis="SiVertexPassiveVis"/>
-->
                <!-- Then the flex
                <ladder    distance="VertexBarrel_r2+VertexBarrel_Support_Thickness+VertexBarrel_Sensitive_Thickness" thickness="FlexCopperThickness" width="FlexWidth" length="VertexBarrel_z2" offset="VertexBarrel_Layer2_offset"    material="Copper"  vis="SiVertexCableVis"/>
                <ladder    distance="VertexBarrel_r2+VertexBarrel_Support_Thickness+VertexBarrel_Sensitive_Thickness+FlexCopperThickness" thickness="FlexKaptonThickness" width="FlexWidth" length="VertexBarrel_z2" offset="VertexBarrel_Layer2_offset"    material="Kapton"  vis="SiVertexCableVis"/>
                -->
            </layer>


            <layer nLadders="VertexBarrel_Layer3_Staves" phi0="0" id="2">
                <!-- No support structure for layer 3 yet! TO BE DONE -->
                <ladder    distance="VertexBarrel_r3" thickness="VertexBarrel_Support_Thickness" width="VertexBarrel_Layer3_width" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_width/2"    material="CarbonFiber"  vis="CarbonFiberVis"/>

                <!-- Then the sensor (normal direction) -->
                <sensitive distance="VertexBarrel_r3+VertexBarrel_Support_Thickness" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer3_width_sensitive" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_width_sensitive/2" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexBarrel_Layer3_nModules" dz="dual_z_spacing" z_length="dual_z"/>

                <!-- with its passive periphery
                <ladder    distance="VertexBarrel_r3+VertexBarrel_Support_Thickness" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer3_width_periphery" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_width_sensitive"    material="Copper"  vis="SiVertexPassiveVis"/>
-->
                <!-- Then the flex 
                <ladder    distance="VertexBarrel_r3+VertexBarrel_Sensitive_Thickness" thickness="FlexCopperThickness" width="FlexWidth" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_width"    material="Copper"  vis="SiVertexCableVis"/> 
                <ladder    distance="VertexBarrel_r3+VertexBarrel_Sensitive_Thickness+FlexCopperThickness" thickness="FlexKaptonThickness" width="FlexWidth" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_width"    material="Kapton"  vis="SiVertexCableVis"/> 
                -->
            </layer>

            <layer nLadders="VertexBarrel_Layer3_Staves" phi0="0" id="3">
                <!-- No support structure for layer 3 yet! TO BE DONE -->
                <ladder    distance="VertexBarrel_r3+VertexBarrel_Layer3_offset_r" thickness="VertexBarrel_Support_Thickness" width="VertexBarrel_Layer3_width" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_overlap-VertexBarrel_Layer3_width/2"    material="CarbonFiber"  vis="CarbonFiberVis"/>

                <!-- Then the sensor (inverted direction) -->
                <sensitive distance="VertexBarrel_r3+VertexBarrel_Support_Thickness+VertexBarrel_Layer3_offset_r" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer3_width_sensitive" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_overlap-VertexBarrel_Layer3_width_sensitive/2" material="Silicon" vis="SiVertexSensitiveVis" nModules="VertexBarrel_Layer3_nModules" dz="dual_z_spacing" z_length="dual_z"/>

                <!-- with its passive periphery 
                <ladder    distance="VertexBarrel_r3+VertexBarrel_Support_Thickness+VertexBarrel_Layer3_offset_r" thickness="VertexBarrel_Sensitive_Thickness" width="VertexBarrel_Layer3_width_periphery" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_overlap-VertexBarrel_Layer3_width_sensitive"    material="Copper"  vis="SiVertexPassiveVis" nz="1" dz="0.1*mm" z_length="51.2*mm"/>
                -->

                <!-- Then the flex 
                <ladder    distance="VertexBarrel_r3+VertexBarrel_Sensitive_Thickness+VertexBarrel_Layer3_offset_r" thickness="FlexCopperThickness" width="FlexWidth" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_overlap-VertexBarrel_Layer3_width"    material="Copper"  vis="SiVertexCableVis"/>
                <ladder    distance="VertexBarrel_r3+VertexBarrel_Sensitive_Thickness+FlexCopperThickness+VertexBarrel_Layer3_offset_r" thickness="FlexKaptonThickness" width="FlexWidth" length="VertexBarrel_z3" offset="VertexBarrel_Layer3_offset+VertexBarrel_Layer3_overlap-VertexBarrel_Layer3_width"    material="Kapton"  vis="SiVertexCableVis"/>
                -->
            </layer>
        </detector>
    </detectors>

<!--        
        <detector>
            <detector name="VertexVerticalCable" type="TrackerEndcapSupport_o1_v01" reflect="true"  region="VertexEndcapRegion">
	        <envelope>
		        <shape type="Assembly"/>
    	    </envelope>
	        <layer id="1" inner_r="VertexBarrel_r1" inner_z="VertexBarrel_zmax+1*mm" outer_r="Vertex_outer_radius-5*env_safety" vis="SiVertexCableVis">
		        <slice material="Copper" thickness="0.02*mm" />
    	    </layer>
        </detector>
-->

    <plugins>
        <plugin name="DD4hep_GenericSurfaceInstallerPlugin">
            <argument value="VertexEndcap"/> 
            <argument value="dimension=2"/>
            <argument value="u_x=-1."/>
            <argument value="v_z=1."/>
            <argument value="n_y=1."/>
        </plugin>
    </plugins>



    
</lccdd>
